(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{242:function(e,t,a){e.exports=a(430)},251:function(e,t,a){},252:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},253:function(e,t,a){},264:function(e,t,a){},265:function(e,t,a){e.exports=a.p+"static/media/logo.451e317d.png"},364:function(e,t,a){},429:function(e,t,a){},430:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(28),c=a.n(r),o=a(37),i=a(208),l=a(57),u=a(106),d={currentUser:null,messageId:null},m=Object(l.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return Object(u.a)({},e,{currentUser:t.payload.current_user});case"CLEAR_USER":return Object(u.a)({},e,{currentUser:null,messageId:null});case"ACTIVE_MESSAGE":return Object(u.a)({},e,{messageId:t.messageId});default:return e}}}),p=Object(l.createStore)(m,Object(i.composeWithDevTools)()),h=(a(251),a(21)),g=a(22),f=a(24),v=a(23),b=a(25),y=(a(252),a(253),a(142)),E=a.n(y);E.a.initializeApp({apiKey:"AIzaSyAKtxUcBXaxMti9m6bWzNvzaFdQmozbn7Y",authDomain:"mychatroom-b2f28.firebaseapp.com",databaseURL:"https://mychatroom-b2f28.firebaseio.com",projectId:"mychatroom-b2f28",storageBucket:"mychatroom-b2f28.appspot.com",messagingSenderId:"768250175875",appId:"1:768250175875:web:8dadc6640e9dbd71"});var L=E.a,O=a(447),I=a(439),j=a(438),S=a(232),C=a(231),k=a(441),M=a(436),R=a(431),U=(a(264),{logo:a(265)}),w=new L.auth.GoogleAuthProvider,N=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(f.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(s)))).state={buttonLoading:!1,firebaseUserRef:L.database().ref("users"),presenceRef:L.database().ref("presence")},a.handleLogin=function(){a.setState({buttonLoading:!0}),L.auth().signInWithPopup(w).then(function(e){console.log("completed"),a.createUser(e),a.setState({buttonLoading:!1})}).catch(function(e){console.log("err...",e),a.setState({buttonLoading:!1})})},a.handleLogout=function(){a.state.presenceRef.child(a.props.user.uid).remove(),L.auth().signOut()},a.userValue=function(e){return{displayName:e.displayName,email:e.email,uid:e.uid,photoURL:e.photoURL,uniqueName:"",friendsList:["welcome"]}},a.createUser=function(e){var t=e.user,n=a.state.firebaseUserRef;console.log(t),n.child(t.uid).set(a.userValue(t)),console.log("user updated!!",t)},a}return Object(b.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.state.buttonLoading,t=this.props,a=(t.profilePic,t.user);return s.a.createElement("div",{className:"header_container"},s.a.createElement("div",{className:"logo"},s.a.createElement("img",{src:U.logo})),s.a.createElement("ul",null,a?s.a.createElement("li",null,s.a.createElement(k.a,{trigger:s.a.createElement("a",{className:"pic_area"},s.a.createElement("img",{className:"profile_pic",src:a.photoURL})),position:"bottom right",on:"click"},s.a.createElement("div",null,s.a.createElement(M.a,null),s.a.createElement(R.a,{primary:!0,onClick:this.handleLogout},"Logout")))):s.a.createElement("li",null,s.a.createElement(R.a,{primary:!0,onClick:this.handleLogin,loading:e,disabled:e},"Login"))))}}]),t}(n.Component),A=Object(o.b)(function(e){return{user:e.user.currentUser}},null)(N),P=a(443),T=a(233),_=a(77),D=a(437),B=a(218),F=a.n(B),x=(a(364),function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(f.a)(this,Object(v.a)(t).call(this,e))).state={activeItem:"inbox",firebaseChatListRef:L.database().ref("users"),firebaseProfileRef:L.database(),messagesRef:L.database().ref("messages"),presenceRef:L.database().ref("presence"),chatList:[],chatTemplate:[],searchKey:"",userList:[],key:null,searchLoading:!1,presenceList:[]},a.presenceListener=function(){var e=[];a.state.presenceRef.on("child_added",function(t){e.push(t.val()),console.log("console beffore push",a.state.presenceList),a.setState({presenceList:e},function(){return console.log("child_added state data...",a.state.presenceList)})}),a.state.presenceRef.on("child_removed",function(t){var n=t.val(),s=e.filter(function(e){return e.uid!==n.uid});a.setState({presenceList:s}),console.log(" child_removed state data...",a.state.presenceList)})},a.handleChange=F.a.debounce(function(e){console.log(a.state.searchKey),a.setState({searchKey:e.target.value,searchLoading:!1},function(){return a.searchChatList()})},1500),a.searchChatList=function(){var e=[],t=a.state,n=t.firebaseChatListRef,s=t.searchKey;a.setState({userList:[]}),0==s.length||n.orderByChild("displayName").equalTo("".concat(s)).on("child_added",function(t){var n=t.val();e.push(n),a.setState({userList:e},function(){a.renderUserList()})})},a.chatListListener=function(){var e=[];a.state.firebaseProfileRef.ref(a.props.user.uid).child("messages/direct").on("child_added",function(t){var n=t.val();e.push(n),console.log(e),a.setState({chatList:e},function(){a.renderChatList()})})},a.handleItemClick=function(e,t){var n=t.name;a.setState({activeItem:n},function(){return console.log("item Clicked!!!",n)}),a.props.activeMessage(n)},a.checkUserIsFriend=function(e){return e.friendsList.indexOf(a.props.user.uid)},a.createMsg=function(e,t,n){a.state.firebaseProfileRef;var s=a.props.user;return a.setState({key:n},console.log("this.state.key",a.state.key)),"ownMessage"===t?{receiverName:e.displayName,receiverId:e.uid,receiverPic:e.photoURL,key:n,senderDetails:{senderId:s.uid,senderName:s.displayName,senderPic:s.photoURL,timestamp:L.database.ServerValue.TIMESTAMP}}:{receiverName:s.displayName,receiverId:s.uid,receiverPic:s.photoURL,key:n,senderDetails:{senderId:e.uid,senderName:e.displayName,senderPic:e.photoURL,timestamp:L.database.ServerValue.TIMESTAMP}}},a.addMeAsFriend=function(e){var t=a.state,n=(t.messagesRef,t.firebaseProfileRef),s=n.ref(a.props.user.uid).push().key;n.ref(a.props.user.uid).child("messages/direct/".concat(e.uid)).update(a.createMsg(e,"ownMessage",s)),n.ref(e.uid).child("messages/direct/".concat(a.props.user.uid)).update(a.createMsg(e,"",s));var r=[];(r=e.friendsList).push(a.props.user.uid),a.state.firebaseChatListRef.child(e.uid).update({friendsList:r}),a.setState({searchKey:""})},a.renderChatList=function(){var e=[],t=a.state,n=t.chatList,r=t.activeItem,c=a.state.presenceRef.child(a.props.user.uid);return c.set({uid:a.props.user.uid,status:!0}),c.onDisconnect().remove(),n&&a.state.chatList.map(function(t,n){var c=a.state.presenceList.filter(function(e){return e.uid===t.receiverId});console.log("found...",c.length),e.push(s.a.createElement(P.a.Item,{name:t.key,active:r===t.key,onClick:a.handleItemClick,key:n},s.a.createElement("div",{className:"avatar"},s.a.createElement(T.a,{src:t.receiverPic,avatar:!0}),s.a.createElement("span",{className:"status ".concat(c.length>=1&&"active")})),s.a.createElement("span",null,t.receiverName)))}),e},a.renderUserList=function(){console.log("renderUserList...");var e=[],t=a.state,n=(t.activeItem,t.userList);return n&&n.map(function(t,n){t.uid!==a.props.user.uid&&e.push(s.a.createElement(P.a.Item,{onClick:a.handleItemClick,key:n},s.a.createElement(T.a,{src:t.photoURL,avatar:!0}),s.a.createElement("span",null,t.displayName),-1===a.checkUserIsFriend(t)&&s.a.createElement(_.a,{color:"blue"},s.a.createElement(R.a,{color:"blue",onClick:function(){return a.addMeAsFriend(t)}},"connect"))))}),e},a}return Object(b.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.chatListListener(),this.presenceListener()}},{key:"render",value:function(){var e=this,t=this.state,a=(t.activeItem,t.searchKey),n=t.searchLoading;return s.a.createElement(s.a.Fragment,null,s.a.createElement(P.a,{vertical:!0,size:"massive",fluid:!0},s.a.createElement(P.a.Item,null,s.a.createElement(D.a,{icon:"search",placeholder:"Search contact...",onChange:function(t){t.persist(),e.handleChange(t),e.setState({searchKey:t.target.value,searchLoading:!0})},value:a,loading:n})),0===a.length?this.renderChatList():this.renderUserList()),s.a.createElement(R.a,{primary:!0},"ADD GROUP"))}}]),t}(n.Component)),K=Object(o.b)(function(e){return{user:e.user.currentUser}},null)(x),z=a(446),W=a(444),G=a(58),V=(n.Component,a(442)),q=a(440),H=a(220),J=a.n(H),Q=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(f.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(s)))).state={modalOpen:!1},a.handleOpen=function(e){a.setState({modalOpen:!0},function(){return a.props.modalToggle(a.state.modalOpen,e)})},a.isOwnMessage=function(e,t){return e.createdBy.senderId===t.uid?"message__self":""},a.timeFromNow=function(e){return J()(e).fromNow()},a}return Object(b.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.message,n=t.user;return s.a.createElement("div",null,s.a.createElement(V.a,null,s.a.createElement(V.a.Avatar,{src:a.createdBy.senderPic,onClick:function(){return e.handleOpen(a.createdBy.senderPic)}}),s.a.createElement(V.a.Content,{className:this.isOwnMessage(a,n)},s.a.createElement(V.a.Author,{as:"a"},a.createdBy.senderName),s.a.createElement(V.a.Metadata,null,this.timeFromNow(a.timestamp)),s.a.createElement(V.a.Text,null,a.messageContent))))}}]),t}(n.Component),X=a(105),Y=(a(377),function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(f.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(s)))).state={message:"",firebaseMessagesRef:L.database().ref("message")},a.notifyA=function(){return Object(X.b)("Please select the chat!!")},a.createMessage=function(e){var t=a.state.message;return{createdBy:{senderId:e.uid,senderName:e.displayName,senderPic:e.photoURL},messageContent:t,timestamp:L.database.ServerValue.TIMESTAMP}},a.sendMessage=function(e,t){var n=a.state,s=n.message,r=n.firebaseMessagesRef;s&&t?r.child(t).push(a.createMessage(e)).then(function(){a.setState({message:""})}):a.notifyA()},a}return Object(b.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.state.message,a=this.props,n=a.user,r=a.messageId;return s.a.createElement(z.a,{className:"message__form"},s.a.createElement(X.a,{position:X.b.POSITION.TOP_RIGHT}),s.a.createElement(D.a,{fluid:!0,name:"Message",style:{marginBottom:"0.7em"},label:s.a.createElement(R.a,{icon:"add"}),labelPosition:"left",placeholder:"Write your message",value:t,onChange:function(t){return e.setState({message:t.target.value})}}),s.a.createElement(R.a.Group,{widths:"2",icon:!0},s.a.createElement(R.a,{color:"orange",content:"Add Reply",labelPosition:"left",icon:"edit",onClick:function(){return e.sendMessage(n,r)}}),s.a.createElement(R.a,{color:"teal",content:"Upload Media",labelPosition:"right",icon:"cloud upload"})))}}]),t}(n.Component)),$=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(f.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={modalToggle:!1,image:null,firebaseMessagesRef:L.database().ref("message"),messages:null},a.modalToggle=function(e,t){a.setState({modalToggle:e,image:t})},a.handleClose=function(){a.setState({modalToggle:!1})},a.displayMessagesListener=function(e){var t=[],n=a.state.firebaseMessagesRef;e&&n.child(e).on("child_added",function(e){console.log(e.val());var n=e.val();t.push(n),a.setState({messages:t},function(){a.displayMessages()})})},a.displayMessages=function(){var e=[],t=a.state.messages,n=a.props.user;return console.log("messagessss..",t),t.map(function(t,r){console.log("messageContent...",t),e.push(s.a.createElement(Q,{user:n,modalToggle:a.modalToggle,message:t,key:r}))}),e},a}return Object(b.a)(t,e),Object(g.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({messages:null}),this.displayMessagesListener(e.messageId)}},{key:"render",value:function(){var e=this.state,t=e.modalToggle,a=e.image,n=e.messages,r=this.props,c=r.user,o=r.messageId;return console.log("messageId...",o),s.a.createElement(s.a.Fragment,null,s.a.createElement(z.a,null,s.a.createElement(V.a.Group,{className:"messages"},n&&this.displayMessages()),s.a.createElement(Y,{user:c,messageId:o})),s.a.createElement(q.a,{open:t,onClose:this.handleClose},s.a.createElement(q.a.Header,null,"User Name"),s.a.createElement(q.a.Content,{image:!0},s.a.createElement(T.a,{wrapped:!0,size:"medium",src:a}),s.a.createElement(q.a.Description,null,s.a.createElement(W.a,null,"Default Profile Image"),s.a.createElement("p",null,"We've found the following gravatar image associated with your e-mail address."),s.a.createElement("p",null,"Is it okay to use this photo?")))))}}]),t}(n.Component),Z=(a(429),function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(f.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(s)))).state={messageId:null},a.activeMessage=function(e){a.setState({messageId:e},function(){return a.props.setActiveMessage(e)})},a}return Object(b.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.props.user;return s.a.createElement(s.a.Fragment,null,s.a.createElement(A,null),e&&s.a.createElement("div",{style:{padding:"10px"}},s.a.createElement(j.a,null,s.a.createElement(S.a,null,s.a.createElement(C.a,{mobile:8,computer:5},s.a.createElement(K,{activeMessage:this.activeMessage})),s.a.createElement(C.a,{computer:8},s.a.createElement($,{user:e,messageId:this.state.messageId}))))))}}]),t}(n.Component)),ee=Object(o.b)(function(e){return{user:e.user.currentUser,messageId:e.user.currentUser&&e.user.currentUser.messageId}},{setActiveMessage:function(e){return{type:"ACTIVE_MESSAGE",messageId:e}}})(Z),te=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(f.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(s)))).state={user:null,loading:!0},a}return Object(b.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this;L.auth().onAuthStateChanged(function(t){t?(console.log(t),e.setState({user:t}),e.props.setUser(t),e.setState({loading:!1})):(console.log("no user!!!!"),e.props.clearUser(),e.setState({user:null,loading:!1}))})}},{key:"render",value:function(){var e=this.state,t=(e.user,e.loading);return s.a.createElement("div",{className:""},t?s.a.createElement(O.a,{active:!0},s.a.createElement(I.a,{active:!0,size:"big",content:"Loading your chat"})):s.a.createElement(ee,null))}}]),t}(n.Component),ae=Object(o.b)(null,{setUser:function(e){return{type:"SET_USER",payload:{current_user:e}}},clearUser:function(){return{type:"CLEAR_USER"}}})(te);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(o.a,{store:p},s.a.createElement(ae,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[242,1,2]]]);
//# sourceMappingURL=main.b2f332de.chunk.js.map